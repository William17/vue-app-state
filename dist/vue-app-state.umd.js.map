{"version":3,"file":"vue-app-state.umd.js","sources":["../src/storage.js","../src/state.js","../src/index.js"],"sourcesContent":["class Storage {\r\n  constructor(name, localStorage) {\r\n    this.prefix = name + '/'\r\n    this.storage = localStorage\r\n    this._cache = {}\r\n  }\r\n\r\n  _parseKey(name) {\r\n    return this.prefix + name\r\n  }\r\n\r\n  $set(key, value) {\r\n    key = this._parseKey(key)\r\n    value = JSON.stringify(value)\r\n    this._cache[key] = JSON.parse(value)\r\n    this.storage.setItem(key, value)\r\n  }\r\n\r\n  $get(key) {\r\n    key = this._parseKey(key)\r\n    if (!this._cache.hasOwnProperty(key)) {\r\n      this._cache[key] = JSON.parse(this.storage.getItem(key))\r\n    }\r\n    return this._cache[key]\r\n  }\r\n\r\n  $remove(key) {\r\n    key = this._parseKey(key)\r\n    delete this._cache[key]\r\n    return this.storage.removeItem(key)\r\n  }\r\n\r\n  $keys() {\r\n    return Object.keys(this.storage)\r\n    .filter((item) => {\r\n      return item.indexOf(this.prefix) > -1\r\n    })\r\n    .map((item) => {\r\n      return item.replace(this.prefix, '')\r\n    })\r\n  }\r\n}\r\n\r\nexport { Storage as default }\r\n","import Storage from './storage'\r\n\r\nconst proto = {\r\n  $storage(name) {\r\n    const __internal__ = this.__internal__\r\n    let storage = __internal__.storages[name]\r\n    if (!storage) {\r\n      const localStorage = __internal__.localStorage\r\n      const realName = __internal__.prefix + name\r\n      storage =  new Storage(realName, localStorage)\r\n      __internal__.storages[name] = storage\r\n    }\r\n    return storage\r\n  },\r\n  $get(key) {\r\n    return this.__internal__.rootStorage.$get(key)\r\n  },\r\n  $set(key, value) {\r\n    return this.__internal__.rootStorage.$set(key, value)\r\n  },\r\n  $remove(key) {\r\n    return this.__internal__.rootStorage.$remove(key)\r\n  },\r\n  $keys() {\r\n    return this.__internal__.rootStorage.$keys()\r\n  }\r\n}\r\n\r\nclass State {\r\n  constructor(options = {}) {\r\n    const prefix = options.prefix || 'APP_STATE/'\r\n    const localStorage = options.localStorage || (typeof localStorage !== 'undefined'\r\n                                                  ? localStorage\r\n                                                  : window.localStorage)\r\n    const rootStorage = new Storage(prefix, localStorage)\r\n    const __internal__ = {\r\n      prefix: prefix,\r\n      storages: {},\r\n      localStorage: localStorage,\r\n      rootStorage: rootStorage\r\n    }\r\n    Object.defineProperty(this, '__internal__', {\r\n      value: __internal__,\r\n      writeable: false,\r\n      configurable: false,\r\n      enumerable: false\r\n    })\r\n    Object.keys(proto).forEach((item) => {\r\n      Object.defineProperty(this, item, {\r\n        value: proto[item],\r\n        writeable: false,\r\n        configurable: false,\r\n        enumerable: false\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nexport { State as default }\r\n","import State from './state'\r\n\r\nfunction install(Vue) {\r\n  Vue.mixin({\r\n    beforeCreate() {\r\n      const options = this.$options.appState\r\n      if (options !== undefined) {\r\n        this.$appState = new State(options)\r\n      } else if (this.$parent) {\r\n        this.$appState = this.$parent.$appState\r\n      } else {\r\n        this.$appState = new State(options)\r\n      }\r\n    }\r\n  })\r\n}\r\nconst AppState = { install }\r\n\r\nexport { AppState as default }\r\n"],"names":["Storage","name","localStorage","prefix","storage","_cache","this","key","value","_parseKey","JSON","stringify","parse","setItem","hasOwnProperty","getItem","removeItem","Object","keys","filter","item","indexOf","_this","map","replace","proto","$storage","__internal__","storages","realName","$get","rootStorage","$set","$remove","$keys","State","options","window","defineProperty","writeable","configurable","enumerable","forEach","install","Vue","mixin","beforeCreate","$options","appState","undefined","$appState","$parent"],"mappings":"4bAAMA,wBACQC,EAAMC,kBACXC,OAASF,EAAO,SAChBG,QAAUF,OACVG,OAAS,4DAGNJ,UACDK,KAAKH,OAASF,+BAGlBM,EAAKC,GACRD,EAAMD,KAAKG,UAAUF,GACrBC,EAAQE,KAAKC,UAAUH,QAClBH,OAAOE,GAAOG,KAAKE,MAAMJ,QACzBJ,QAAQS,QAAQN,EAAKC,gCAGvBD,UACHA,EAAMD,KAAKG,UAAUF,GAChBD,KAAKD,OAAOS,eAAeP,UACzBF,OAAOE,GAAOG,KAAKE,MAAMN,KAAKF,QAAQW,QAAQR,KAE9CD,KAAKD,OAAOE,mCAGbA,UACNA,EAAMD,KAAKG,UAAUF,UACdD,KAAKD,OAAOE,GACZD,KAAKF,QAAQY,WAAWT,qDAIxBU,OAAOC,KAAKZ,KAAKF,SACvBe,OAAO,SAACC,UAC6B,EAA7BA,EAAKC,QAAQC,EAAKnB,UAE1BoB,IAAI,SAACH,UACGA,EAAKI,QAAQF,EAAKnB,OAAQ,2CCpCjCsB,EAAQ,CACZC,kBAASzB,OACD0B,EAAerB,KAAKqB,aACtBvB,EAAUuB,EAAaC,SAAS3B,OAC/BG,EAAS,KACNF,EAAeyB,EAAazB,aAC5B2B,EAAWF,EAAaxB,OAASF,EACvCG,EAAW,IAAIJ,EAAQ6B,EAAU3B,GACjCyB,EAAaC,SAAS3B,GAAQG,SAEzBA,GAET0B,cAAKvB,UACID,KAAKqB,aAAaI,YAAYD,KAAKvB,IAE5CyB,cAAKzB,EAAKC,UACDF,KAAKqB,aAAaI,YAAYC,KAAKzB,EAAKC,IAEjDyB,iBAAQ1B,UACCD,KAAKqB,aAAaI,YAAYE,QAAQ1B,IAE/C2B,wBACS5B,KAAKqB,aAAaI,YAAYG,UAInCC,EACJ,wBAAYC,yDAAU,iBACdjC,EAASiC,EAAQjC,QAAU,aAC3BD,EAAekC,EAAQlC,oBAAyC,IAAjBA,EACLA,EACAmC,OAAOnC,cAEjDyB,EAAe,CACnBxB,OAAQA,EACRyB,SAAU,GACV1B,aAAcA,EACd6B,YALkB,IAAI/B,EAAQG,EAAQD,IAOxCe,OAAOqB,eAAehC,KAAM,eAAgB,CAC1CE,MAAOmB,EACPY,WAAW,EACXC,cAAc,EACdC,YAAY,IAEdxB,OAAOC,KAAKO,GAAOiB,QAAQ,SAACtB,GAC1BH,OAAOqB,eAAehB,EAAMF,EAAM,CAChCZ,MAAOiB,EAAML,GACbmB,WAAW,EACXC,cAAc,EACdC,YAAY,aCpCH,CAAEE,QAdnB,SAAiBC,GACfA,EAAIC,MAAM,CACRC,4BACQV,EAAU9B,KAAKyC,SAASC,cACdC,IAAZb,OACGc,UAAY,IAAIf,EAAMC,GAClB9B,KAAK6C,aACTD,UAAY5C,KAAK6C,QAAQD,eAEzBA,UAAY,IAAIf,EAAMC"}