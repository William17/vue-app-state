{"version":3,"file":"vue-app-state.umd.js","sources":["../src/storage.js","../src/state.js","../src/index.js"],"sourcesContent":["class Storage {\n  constructor(name, localStorage) {\n    this.prefix = name + '/'\n    this.storage = localStorage\n    this._cache = {}\n  }\n\n  _parseKey(name) {\n    return this.prefix + name\n  }\n\n  $set(key, value) {\n    key = this._parseKey(key)\n    value = JSON.stringify(value)\n    this._cache[key] = JSON.parse(value)\n    this.storage.setItem(key, value)\n  }\n\n  $get(key) {\n    key = this._parseKey(key)\n    if (!this._cache.hasOwnProperty(key)) {\n      this._cache[key] = JSON.parse(this.storage.getItem(key))\n    }\n    return this._cache[key]\n  }\n\n  $remove(key) {\n    key = this._parseKey(key)\n    delete this._cache[key]\n    return this.storage.removeItem(key)\n  }\n\n  $keys() {\n    return Object.keys(this.storage)\n    .filter((item) => {\n      return item.indexOf(this.prefix) > -1\n    })\n    .map((item) => {\n      return item.replace(this.prefix, '')\n    })\n  }\n}\n\nexport { Storage as default }\n","import Storage from './storage'\n\nconst proto = {\n  $storage(name) {\n    const __internal__ = this.__internal__\n    let storage = __internal__.storages[name]\n    if (!storage) {\n      const localStorage = __internal__.localStorage\n      const realName = __internal__.prefix + name\n      storage =  new Storage(realName, localStorage)\n      __internal__.storages[name] = storage\n    }\n    return storage\n  },\n  $get(key) {\n    return this.__internal__.rootStorage.$get(key)\n  },\n  $set(key, value) {\n    return this.__internal__.rootStorage.$set(key, value)\n  },\n  $remove(key) {\n    return this.__internal__.rootStorage.$remove(key)\n  },\n  $keys() {\n    return this.__internal__.rootStorage.$keys()\n  }\n}\n\nclass State {\n  constructor(options = {}) {\n    const prefix = options.prefix || 'APP_STATE/'\n    const localStorage = options.localStorage || (typeof localStorage !== 'undefined'\n                                                  ? localStorage\n                                                  : window.localStorage)\n    const rootStorage = new Storage(prefix, localStorage)\n    const __internal__ = {\n      prefix: prefix,\n      storages: {},\n      localStorage: localStorage,\n      rootStorage: rootStorage\n    }\n    Object.defineProperty(this, '__internal__', {\n      value: __internal__,\n      writeable: false,\n      configurable: false,\n      enumerable: false\n    })\n    Object.keys(proto).forEach((item) => {\n      Object.defineProperty(this, item, {\n        value: proto[item],\n        writeable: false,\n        configurable: false,\n        enumerable: false\n      })\n    })\n  }\n}\n\nexport { State as default }\n","import State from './state'\n\nfunction install(Vue) {\n  Vue.mixin({\n    beforeCreate() {\n      const options = this.$options.appState\n      if (options !== undefined) {\n        this.$appState = new State(options)\n      } else if (this.$parent) {\n        this.$appState = this.$parent.$appState\n      } else {\n        this.$appState = new State(options)\n      }\n    }\n  })\n}\nconst AppState = { install }\n\nexport { AppState as default }\n"],"names":["Storage","name","localStorage","prefix","storage","_cache","this","key","value","_parseKey","JSON","stringify","parse","setItem","hasOwnProperty","getItem","removeItem","Object","keys","filter","item","indexOf","_this","map","replace","proto","__internal__","storages","realName","rootStorage","$get","$set","$remove","$keys","State","options","window","defineProperty","forEach","Vue","mixin","$options","appState","undefined","$appState","$parent"],"mappings":"4bAAMA,wBACQC,EAAMC,kBACXC,OAASF,EAAO,SAChBG,QAAUF,OACVG,OAAS,4DAGNJ,UACDK,KAAKH,OAASF,+BAGlBM,EAAKC,KACFF,KAAKG,UAAUF,KACbG,KAAKC,UAAUH,QAClBH,OAAOE,GAAOG,KAAKE,MAAMJ,QACzBJ,QAAQS,QAAQN,EAAKC,gCAGvBD,YACGD,KAAKG,UAAUF,GAChBD,KAAKD,OAAOS,eAAeP,UACzBF,OAAOE,GAAOG,KAAKE,MAAMN,KAAKF,QAAQW,QAAQR,KAE9CD,KAAKD,OAAOE,mCAGbA,YACAD,KAAKG,UAAUF,UACdD,KAAKD,OAAOE,GACZD,KAAKF,QAAQY,WAAWT,qDAIxBU,OAAOC,KAAKZ,KAAKF,SACvBe,OAAO,SAACC,UAC6B,EAA7BA,EAAKC,QAAQC,EAAKnB,UAE1BoB,IAAI,SAACH,UACGA,EAAKI,QAAQF,EAAKnB,OAAQ,2CCpCjCsB,EAAQ,mBACHxB,OACDyB,EAAepB,KAAKoB,aACtBtB,EAAUsB,EAAaC,SAAS1B,OAC/BG,EAAS,KACNF,EAAewB,EAAaxB,aAC5B0B,EAAWF,EAAavB,OAASF,IAC5B,IAAID,EAAQ4B,EAAU1B,KACpByB,SAAS1B,GAAQG,SAEzBA,iBAEJG,UACID,KAAKoB,aAAaG,YAAYC,KAAKvB,kBAEvCA,EAAKC,UACDF,KAAKoB,aAAaG,YAAYE,KAAKxB,EAAKC,qBAEzCD,UACCD,KAAKoB,aAAaG,YAAYG,QAAQzB,4BAGtCD,KAAKoB,aAAaG,YAAYI,UAInCC,EACJ,wBAAYC,yDAAU,iBACdhC,EAASgC,EAAQhC,QAAU,aAC3BD,EAAeiC,EAAQjC,oBAAyC,IAAjBA,EACLA,EACAkC,OAAOlC,cAEjDwB,EAAe,QACXvB,WACE,gBACID,cAJI,IAAIF,EAAQG,EAAQD,WAOjCmC,eAAe/B,KAAM,eAAgB,OACnCoB,aACI,gBACG,cACF,WAEPR,KAAKO,GAAOa,QAAQ,SAAClB,UACnBiB,eAAef,EAAMF,EAAM,OACzBK,EAAML,cACF,gBACG,cACF,aCpCH,SAdjB,SAAiBmB,KACXC,MAAM,6BAEAL,EAAU7B,KAAKmC,SAASC,cACdC,IAAZR,OACGS,UAAY,IAAIV,EAAMC,GAClB7B,KAAKuC,aACTD,UAAYtC,KAAKuC,QAAQD,eAEzBA,UAAY,IAAIV,EAAMC"}